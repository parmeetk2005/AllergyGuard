!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c7702472-166d-4c69-b2e3-95f566477ca8",e._sentryDebugIdIdentifier="sentry-dbid-c7702472-166d-4c69-b2e3-95f566477ca8")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4436,7346],{51229:function(e,t,r){r.r(t);var a,n,o,l=r(94746);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}t.default=function(e){return l.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),l.createElement("mask",{id:"builder_io_logo_svg__a",width:20,height:20,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},a||(a=l.createElement("path",{fill:"#D9D9D9",d:"M0 0h20v20H0z"}))),n||(n=l.createElement("g",{clipPath:"url(#builder_io_logo_svg__b)"},l.createElement("path",{fill:"#18B4F4",d:"M15.77 6.83a3.82 3.82 0 0 1-1.422 2.978L4.13 4.006A.54.54 0 0 1 4.4 3h7.542a3.826 3.826 0 0 1 3.827 3.83"}),l.createElement("path",{fill:"#FD6B3C",d:"M15.77 12.787a3.83 3.83 0 0 1-3.828 3.83H4.4a.541.541 0 0 1-.27-1.006l4.02-2.283 6.196-3.52a3.82 3.82 0 0 1 1.422 2.979"}),l.createElement("path",{fill:"#A97FF2",d:"m14.348 9.808-6.196 3.52L4.13 15.61a.5.5 0 0 0-.107.079 8.42 8.42 0 0 0 2.389-5.882 8.4 8.4 0 0 0-2.388-5.882.6.6 0 0 0 .108.08z"}))),o||(o=l.createElement("defs",null,l.createElement("clipPath",{id:"builder_io_logo_svg__b"},l.createElement("path",{fill:"#fff",d:"M3 3h13.63v13.63H3z"})))))}},57931:function(e,t,r){r.r(t);var a,n,o=r(94746);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}t.default=function(e){return o.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),o.createElement("mask",{id:"figma_logo_color_svg__a",width:20,height:20,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},a||(a=o.createElement("path",{fill:"#D9D9D9",d:"M0 0h20v20H0z"}))),n||(n=o.createElement("g",{mask:"url(#figma_logo_color_svg__a)"},o.createElement("path",{fill:"#24CB71",d:"M5 14.358a2.27 2.27 0 0 1 2.272-2.271h2.271v2.271a2.272 2.272 0 0 1-4.543 0"}),o.createElement("path",{fill:"#FF7237",d:"M9.543 3v4.543h2.272a2.272 2.272 0 0 0 0-4.543z"}),o.createElement("path",{fill:"#00B6FF",d:"M11.796 12.087a2.272 2.272 0 1 0 0-4.544 2.272 2.272 0 0 0 0 4.543"}),o.createElement("path",{fill:"#FF3737",d:"M5 5.272a2.27 2.27 0 0 0 2.272 2.271h2.271V3H7.272A2.27 2.27 0 0 0 5 5.272"}),o.createElement("path",{fill:"#874FFF",d:"M5 9.815a2.27 2.27 0 0 0 2.272 2.271h2.271V7.543H7.272A2.27 2.27 0 0 0 5 9.815"}))))}},7593:function(e,t,r){r.r(t);var a,n,o=r(94746);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}t.default=function(e){return o.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),o.createElement("mask",{id:"figma_logo_outline_svg__a",width:21,height:20,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},a||(a=o.createElement("path",{fill:"#D9D9D9",d:"M.286 0h20v20h-20z"}))),n||(n=o.createElement("g",{mask:"url(#figma_logo_outline_svg__a)"},o.createElement("path",{fill:"#fff",stroke:"#fff",strokeWidth:.25,d:"M5.772 5.716c0 .872.419 1.647 1.065 2.134a2.67 2.67 0 0 0-1.065 2.135c0 .873.419 1.647 1.065 2.135a2.67 2.67 0 0 0-1.065 2.134 2.68 2.68 0 0 0 2.683 2.67 2.704 2.704 0 0 0 2.705-2.693v-2.106c.446.333 1 .53 1.599.53h.046a2.67 2.67 0 0 0 1.606-4.805 2.67 2.67 0 0 0-1.606-4.805H8.443a2.67 2.67 0 0 0-2.67 2.67Zm6.987 5.867a1.598 1.598 0 0 1 0-3.196h.046a1.598 1.598 0 1 1 0 3.196zM8.443 8.387h1.645v3.196h-1.65a1.598 1.598 0 0 1 .005-3.196Zm-.005 4.269h1.65v1.575c0 .892-.734 1.621-1.633 1.621-.887 0-1.61-.719-1.61-1.598s.712-1.595 1.592-1.598Zm1.65-5.342H8.443a1.598 1.598 0 1 1 0-3.196h1.645zm2.717 0H11.16V4.118h1.645a1.598 1.598 0 1 1 0 3.196Z"}))))}},85024:function(e,t,r){r.r(t);var a,n,o,l,s,i,d,c,u,f,p,_=r(94746);function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}t.default=function(e){return _.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),_.createElement("mask",{id:"lovable_logo_color_svg__a",width:20,height:20,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},a||(a=_.createElement("path",{fill:"#D9D9D9",d:"M0 0h20v20H0z"}))),_.createElement("g",{mask:"url(#lovable_logo_color_svg__a)"},_.createElement("mask",{id:"lovable_logo_color_svg__b",width:16,height:14,x:2,y:3,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},n||(n=_.createElement("path",{fill:"#fff",d:"M9.66 16.63q-.229 0-.462-.083a1.1 1.1 0 0 1-.405-.255l-1.118-1.028a55 55 0 0 1-3.967-4.032Q2 9.288 2 7.1q0-1.75 1.175-2.924Q4.349 3 6.085 3q.99 0 1.929.456.938.457 1.647 1.42.772-.963 1.672-1.42A4.15 4.15 0 0 1 13.236 3q1.737 0 2.911 1.175 1.175 1.174 1.175 2.924 0 2.19-1.705 4.136-1.704 1.948-3.977 4.035l-1.11 1.022q-.173.172-.406.255t-.463.083"}))),_.createElement("g",{mask:"url(#lovable_logo_color_svg__b)"},o||(o=_.createElement("path",{fill:"#FF1814",d:"M9.66 16.63q-.229 0-.462-.083a1.1 1.1 0 0 1-.405-.255l-1.118-1.028a55 55 0 0 1-3.967-4.032Q2 9.288 2 7.1q0-1.75 1.175-2.924Q4.349 3 6.085 3q.99 0 1.929.456.938.457 1.647 1.42.772-.963 1.672-1.42A4.15 4.15 0 0 1 13.236 3q1.737 0 2.911 1.175 1.175 1.174 1.175 2.924 0 2.19-1.705 4.136-1.704 1.948-3.977 4.035l-1.11 1.022q-.173.172-.406.255t-.463.083"})),l||(l=_.createElement("g",{filter:"url(#lovable_logo_color_svg__c)"},_.createElement("ellipse",{cx:11.802,cy:19.643,fill:"#FFAB25",rx:5.793,ry:5.868,transform:"rotate(-105 11.802 19.643)"}))),s||(s=_.createElement("g",{filter:"url(#lovable_logo_color_svg__d)"},_.createElement("ellipse",{cx:15.459,cy:18.663,fill:"#FFAB25",rx:5.793,ry:5.868,transform:"rotate(-105 15.459 18.663)"}))),i||(i=_.createElement("g",{filter:"url(#lovable_logo_color_svg__e)"},_.createElement("ellipse",{cx:6.185,cy:13.309,fill:"#FFAB25",rx:5.793,ry:5.868,transform:"rotate(-105 6.185 13.309)"}))),d||(d=_.createElement("g",{filter:"url(#lovable_logo_color_svg__f)"},_.createElement("ellipse",{cx:9.842,cy:12.329,fill:"#FFAB25",rx:5.793,ry:5.868,transform:"rotate(-105 9.842 12.33)"}))),c||(c=_.createElement("g",{filter:"url(#lovable_logo_color_svg__g)"},_.createElement("circle",{cx:-3.362,cy:5.892,r:6.489,fill:"#BE2B29",transform:"rotate(2.384 -3.362 5.892)"}))),u||(u=_.createElement("g",{filter:"url(#lovable_logo_color_svg__h)"},_.createElement("ellipse",{cx:4.879,cy:4.221,fill:"#00C986",rx:4.879,ry:4.221,transform:"matrix(-.67039 -.742 .73084 -.68255 14.35 10.32)"}))),_.createElement("g",{filter:"url(#lovable_logo_color_svg__i)",style:{mixBlendMode:"hard-light"}},f||(f=_.createElement("ellipse",{cx:5.5,cy:4.755,fill:"#297FFF",rx:5.5,ry:4.755,transform:"matrix(-.67039 -.742 .73084 -.68255 17.313 14.435)"}))))),p||(p=_.createElement("defs",null,_.createElement("filter",{id:"lovable_logo_color_svg__c",width:22.634,height:22.503,x:.485,y:8.392,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})),_.createElement("filter",{id:"lovable_logo_color_svg__d",width:22.634,height:22.503,x:4.142,y:7.412,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})),_.createElement("filter",{id:"lovable_logo_color_svg__e",width:22.634,height:22.503,x:-5.132,y:2.058,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})),_.createElement("filter",{id:"lovable_logo_color_svg__f",width:22.634,height:22.503,x:-1.475,y:1.078,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})),_.createElement("filter",{id:"lovable_logo_color_svg__g",width:32.364,height:32.364,x:-19.544,y:-10.29,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:4.846})),_.createElement("filter",{id:"lovable_logo_color_svg__h",width:19.896,height:20.158,x:4.217,y:-6.26,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})),_.createElement("filter",{id:"lovable_logo_color_svg__i",width:21.037,height:21.333,x:6.583,y:-3.558,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},_.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),_.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),_.createElement("feGaussianBlur",{result:"effect1_foregroundBlur_7991_4293",stdDeviation:2.726})))))}},72116:function(e,t,r){r.d(t,{JI:function(){return _},hP:function(){return g}});var a=r(21288),n=r(6273),o=r(31229);let l=new n.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),s=e=>null!=e&&"object"==typeof e&&"name"in e&&"data"in e&&"done"in e;o.z.object({type:o.z.literal("lov-sql"),lovSql:o.z.string(),done:o.z.boolean()});let i=o.z.object({type:o.z.literal("lov_action__link"),url:o.z.string(),text:o.z.string()}),d=o.z.object({type:o.z.literal("lov_action__migrate"),done:o.z.boolean()}),c=o.z.object({type:o.z.literal("lov_action__message_prompt"),message:o.z.string(),text:o.z.string()}),u=o.z.object({type:o.z.literal("lov_action__knowledge")}),f=o.z.object({type:o.z.literal("lov_action__secret_form"),name:o.z.string()}),p=o.z.union([i,d,c,u,f]);function _(e){return e.parts.filter(e=>"done"in e&&e.done&&("search_replace_parts"in e||"content"in e)).length}function g(e){let t=[],r=[],n=null,o=!1,i=!1,d=!1,c=!1,u=!1,f=!1,_=!1,g="",m="",h="",v="",E=null,y="";function b(){var e,b,w,k,C,S;if(h.trim().startsWith("<lov-tool-use")){_=!0;let e=(v=h).match(/name="([^"]*)"/),r=v.match(/data="(\{[\s\S]*?\})"/);e&&r&&n&&!o&&!i&&(t.push(n),t.push({name:e[1],data:r[1],done:!1}),n={content:""})}else if(_){if(v+=h,h.includes("</lov-tool-use>")){_=!1;let e=t[t.length-1];s(e)&&(e.done=!0),v=""}}else if("<thinking>"===h.trim())h="";else if("</thinking>"===h.trim())h="";else if("<lov-code>"===h.trim())n&&t.push(n),o=!0,n={parts:[],done:!1};else if("</lov-code>"===h.trim())n&&"done"in n&&(n.done=!0,t.push(n),n=null),o=!1;else if("<lov-sql>"===h.trim())n&&t.push(n),i=!0,n={type:"lov-sql",lovSql:"",done:!1};else if("</lov-sql>"===h.trim())n&&"lovSql"in n&&(n.done=!0,t.push(n),r.find(e=>"lov_action__migrate"===e.type)||r.push({type:"lov_action__migrate",done:!0}),n=null),i=!1;else if("<lov-actions>"===h.trim())f=!0;else if("</lov-actions>"===h.trim())f=!1,r.push(...(S=y,l.parse(S).map(e=>{var t,r,n,o,l,s,i;return"lov-link"in e?{type:"lov_action__link",url:null===(t=e[":@"])||void 0===t?void 0:t["@_url"],text:null===(n=e["lov-link"])||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r["#text"]}:"lov-knowledge"in e?{type:"lov_action__knowledge"}:"lov-message-prompt"in e?{type:"lov_action__message_prompt",message:null===(o=e[":@"])||void 0===o?void 0:o["@_message"],text:null===(s=e["lov-message-prompt"])||void 0===s?void 0:null===(l=s[0])||void 0===l?void 0:l["#text"]}:"lov-secret-form"in e?{type:"lov_action__secret_form",name:null===(i=e[":@"])||void 0===i?void 0:i["@_name"]}:(a.P.error("Unknown Lov action",{node:e}),null)}).filter(e=>null!==e).reduce((e,t)=>{let r=p.safeParse(t);return r.success?e.push(r.data):a.P.error("Failed to validate Lov action",{action:t,error:r.error}),e},[]))),y="";else if(h.startsWith('<lov-write file_path="'))d=!0,m=(null===(e=h.match(/"([^"]*)"/))||void 0===e?void 0:e[1])||"",o&&n&&"parts"in n&&n.parts.push({file_path:m,content:"",done:!1});else if(h.startsWith('<lov-search-replace file_path="'))c=!0,m=(null===(b=h.match(/"([^"]*)"/))||void 0===b?void 0:b[1])||"",o&&n&&"parts"in n&&n.parts.push({file_path:m,search_replace_parts:[],done:!1});else if(h.startsWith('<lov-delete file_path="'))u=!0,m=(null===(w=h.match(/"([^"]*)"/))||void 0===w?void 0:w[1])||"",o&&n&&"parts"in n&&n.parts.push({file_path:m});else if(h.startsWith('<lov-rename original_file_path="')){let e=(null===(k=h.match(/original_file_path="([^"]*)"/))||void 0===k?void 0:k[1])||"",t=(null===(C=h.match(/new_file_path="([^"]*)"/))||void 0===C?void 0:C[1])||"";o&&n&&"parts"in n&&n.parts.push({original_file_path:e,new_file_path:t})}else if(h.startsWith("<lov-add-dependency>"))g=h.replace("<lov-add-dependency>","").replace("</lov-add-dependency>","").trim(),o&&n&&"parts"in n&&n.parts.push({dependency:g,isDevDependency:!1});else if("</lov-add-dependency>"===h.trim())g="";else if(h.startsWith("<lov-add-dev-dependency>"))g=h.replace("<lov-add-dev-dependency>","").replace("</lov-add-dev-dependency>","").trim(),o&&n&&"parts"in n&&n.parts.push({dependency:g,isDevDependency:!0});else if(h.startsWith("<lov-remove-dependency>")){let e=h.replace("<lov-remove-dependency>","").replace("</lov-remove-dependency>","").trim();o&&n&&"parts"in n&&n.parts.push({removed_dependency:e})}else if("</lov-remove-dependency>"===h.trim())g="";else if("</lov-write>"===h.trim()||"</lov-search-replace>"===h.trim()||"/>"===h.trim()&&u){if(d=!1,c=!1,u=!1,m="",o&&n&&"parts"in n){let e=n.parts[n.parts.length-1];"done"in e&&(e.done=!0)}}else if(o){if(n&&"parts"in n){if(n.parts.length>0){let e=n.parts[n.parts.length-1];if(d&&"content"in e)e.content+=h;else if(c&&"search_replace_parts"in e){if("<lov-search>"===h.trim())e.search_replace_parts.push({search:"",replace:""}),E="search";else if("<lov-replace>"===h.trim())E="replace";else if("</lov-search>"===h.trim()||"</lov-replace>"===h.trim())E=null;else{let t=e.search_replace_parts[e.search_replace_parts.length-1];t&&E&&(t[E]+=h)}}else n.parts.push({content:h})}else n.parts.push({content:h})}}else i?n&&"lovSql"in n&&(n.lovSql+=h):f?y+=h:(n&&"content"in n||(n={content:""}),"content"in n&&(n.content+=h));h=""}for(let t of e)h+=t,"\n"===t&&b();return h&&b(),n&&t.push(n),{parts:t,lovActions:r}}},94311:function(e,t,r){r.d(t,{b:function(){return i}});var a=r(21288),n=r(62449),o=r(2265),l=r(89651);let s={message:"",wasCleared:!0},i=e=>{let{localStorageKey:t}=e,[r,i]=(0,l.Z)("ChatInput-ChatMessage-".concat(t),{defaultValue:s,storageSync:!1,serializer:{parse:e=>{let t=JSON.parse(e);return"string"==typeof t?{message:t,wasCleared:!0}:t},stringify:JSON.stringify}}),d=(0,n.Eh)(e=>e.chatMessage),c=(0,n.Eh)(e=>e.setChatMessage);return(0,o.useEffect)(()=>{r.message&&!r.wasCleared&&c(r.message)},[t,c,r]),{chatMessage:d,setChatMessage:e=>{if(!t){a.P.error("project_id_required_to_set_chat_message");return}c(e),i({message:e,wasCleared:!1})},clearChatMessage:()=>{c(""),i(e=>({...e,wasCleared:!0}))},restoreChatMessage:()=>{c(r.message),r.wasCleared&&i({message:r.message,wasCleared:!1})}}}},54188:function(e,t,r){r.d(t,{d:function(){return E}});var a=r(98507),n=r(49340),o=r(29388),l=r(1787),s=r(21288),i=r(62449),d=r(13673),c=r(21770),u=r(46214),f=r(2265),p=r(2925),_=r(83856),g=r(72116),m=r(94311),h=r(88746),v=r(32935);function E(e){let{projectId:t,finalRedirectUrl:r,onRepoInaccessible:E,onSubmit:y,autoSwitchToCode:b=!1,mutationKey:w,onSuccess:k,localStorageKey:C}=e,S=(0,p.u)(e=>e.currentPage),P=(0,d.ZP)(e=>e.setIsOutOfCreditsDialogOpen),x=(0,i.Eh)(e=>e.setLatestStreamedMessage),M=(0,d.ZP)(e=>e.setScrollToTarget),I=(0,l.M)(r),{restoreChatMessage:R}=(0,m.b)({localStorageKey:C}),{repoAccessibilityResponse:A}=(0,a.C)(t),O=(0,i.Eh)(e=>e.exitConsole),T=(0,d.ZP)(e=>e.setMessage),[j]=(0,n.a)(),F=null==j?void 0:j.uid,B=(0,d.ZP)(e=>e.removeMessage),N=(0,i.Eh)(e=>e.addAbortController),U=(0,i.Eh)(e=>e.removeAbortController),D=(0,i.Eh)(e=>e.setShouldShowTipsAndTricksOnDevServerStart),z=(0,f.useRef)(null),q=async(e,r)=>{let a=r||t;if(!a){s.P.error("Project ID is required to send chat message");return}if(A&&(null==A?void 0:A.accessibility)!=="repo_accessible"&&(null==A?void 0:A.accessibility)!=="repo_not_found"){E&&E(),R();return}let n=_.QE.length,o=_.vM.length,l=_.$F.length;e.client_logs=[..._.QE.slice(Math.max(n-50,0),n)],e.network_requests=[..._.vM.slice(Math.max(o-50,0),o)],e.runtime_errors=[..._.$F.slice(Math.max(l-50,0),l)],_.QE.length=0,_.vM.length=0,_.$F.length=0;let d="";z.current=new AbortController,N(z.current),performance.mark("start-request");let c=!1;await I.postWithStreaming("/projects/".concat(a,"/chat"),e,t=>{if(!c){c=!0,performance.mark("first-token");let t=performance.measure("start-request","start-request","first-token");u.ZP.capture("time_to_first_token",{duration:t.duration,project_id:a,user_id:F,chat_only:!!e.chat_only,is_creation:!!r})}let n=i.Eh.getState();if(n.latestStreamedMessage&&"stopped"in n.latestStreamedMessage&&n.latestStreamedMessage.stopped)return"stop";let o={...t.message,stopped:!!t.message.stopped,status:"running"};x(o);let l=(0,v.A)(o);if(l&&("aiMessage"===l.type||"userMessage"===l.type)?T(t.message.id,l,!0):s.P.error("unknown_message_type",{message:t.message}),t.message.content.includes("</lov-code>")&&!d.includes("</lov-code>")?(O(),_.QE.length=0):t.message.content.includes("<lov-code>")&&!d.includes("<lov-code>")&&(n.consoleContentType,b&&(n.setShowConsole("code"),t.message.id&&n.setActiveMessageId(t.message.id))),t.message.content&&t.message.id===n.activeMessageId)for(let e of(0,g.hP)(t.message.content).parts)"parts"in e&&(n.setConsoleCodeContent(e),d=t.message.content)},z.current.signal),performance.mark("end-request");let f=performance.measure("start-request","start-request","end-request");u.ZP.capture("time_to_last_token",{duration:f.duration,project_id:a,user_id:F,chat_only:!!e.chat_only,is_creation:!!r}),d="",x(void 0),z.current&&U(z.current)},L=(0,i.Eh)(e=>e.setIsSendChatMessageMutationPending),{showErrorDialog:H}=(0,h.t)();return(0,c.D)({mutationKey:w,mutationFn:async e=>{let{body:t,projectId:r,isCreation:a}=e;return t.current_page=S,L(!0),a&&D(!0),q(t,r)},onMutate:e=>{var t,r;let{body:{optimisticImageContentFiles:a,...n},clear:o}=e;n.current_page=S;let l={id:n.id,createdAt:new Date,role:"user",type:"userMessage",selectedElements:null!==(t=n.selected_elements)&&void 0!==t?t:[],content:n.message,tags:null!==(r=n.tags)&&void 0!==r?r:[],images:[],containsError:!!n.contains_error,userId:F,optimistImageUrls:null==a?void 0:a.map(e=>URL.createObjectURL(e))};T(n.id,l,!1),null==y||y(n.message),M({target:"end",align:"end"}),null==o||o()},onSettled:()=>{L(!1),D(!1)},onSuccess:()=>{null==k||k()},onError:(e,t)=>{var r,a,n,l;let{body:i,restore:d}=t;B(i.id),"AbortError"!==e.name&&(e instanceof o.Oq?(s.P.error("send_chat_request_failed",{error:e}),429===e.status?(u.ZP.capture("rate_limit_exceeded"),H(e.message,!1)):402===e.status?(P(!0),u.ZP.capture("out_of_credits_dialog_opened")):503===e.status?(s.P.error("send_chat_request_service_unavailable",{error:e}),H(e.response.details,!1)):e.status>=500?(s.P.error("send_chat_request_internal_error",{error:e}),H(e.message,!1)):H((null===(r=e.response)||void 0===r?void 0:r.detail)||(null===(a=e.response)||void 0===a?void 0:a.details)||e.message||"Request failed",!1)):"message"in e&&"type"in e?(s.P.error("send_chat_request_error",{error:e}),H(e.message,!1)):(s.P.error("send_chat_request_unknown_reason",{message:null==e?void 0:e.message,stack:null==e?void 0:e.stack,isOnline:navigator.onLine,errorType:e instanceof TypeError?"NetworkError":"ApplicationError",isNetworkError:null==e?void 0:null===(n=e.message)||void 0===n?void 0:n.includes("Failed to fetch"),isCorsError:null==e?void 0:null===(l=e.message)||void 0===l?void 0:l.includes("CORS"),isTimeout:(null==e?void 0:e.name)==="TimeoutError",isAbort:(null==e?void 0:e.name)==="AbortError",isDomException:e instanceof DOMException,error:e}),H()),null==d||d())}})}},32935:function(e,t,r){r.d(t,{A:function(){return s},O:function(){return i}});var a=r(21288),n=r(5978);let o=[],l=e=>"string"==typeof e?new Date(e):e instanceof n.EK?e.toDate():new n.EK(e.seconds,e.nanoseconds).toDate(),s=(e,t)=>{var r,n,s,i,d,c,u,f,p,_,g,m,h,v,E,y;switch(e.tag){case"instant-mode-message":if("user"===e.role)return{createdAt:l(e.created_at),role:"user",id:e.id,content:e.content,type:"userMessage",selectedElements:null!==(r=e.selected_elements)&&void 0!==r?r:o,images:null!==(n=e.images)&&void 0!==n?n:o,containsError:null!==(s=e.contains_error)&&void 0!==s&&s,tags:null!==(i=e.tags)&&void 0!==i?i:o,userId:null!==(d=e.user_id)&&void 0!==d?d:void 0};return{createdAt:l(e.created_at),role:"ai",id:e.id,content:e.content,type:"aiMessage",editId:null!==(u=e.edit_id)&&void 0!==u?u:void 0,stopped:!!e.stopped,errors:null!==(f=null===(c=e.errors)||void 0===c?void 0:c.sort((e,t)=>t.created_at.seconds-e.created_at.seconds))&&void 0!==f?f:void 0,langsmithUrl:null!==(p=e.langsmith_url)&&void 0!==p?p:void 0,sqlRunState:null!==(_=e.sql_run_state)&&void 0!==_?_:void 0,persisted:null!==(g=null==t?void 0:t.persisted)&&void 0!==g&&g,status:null!==(m=e.status)&&void 0!==m?m:"completed"};case"branch-switched":return{createdAt:l(e.created_at),id:e.id,type:"branchSwitched",branchName:e.branch_name};case"external-commit-pushed":return{createdAt:l(e.created_at),id:e.id,type:"userCommit",shortCommitHash:null!==(h=e.commit_hash)&&void 0!==h?h:void 0,commitMessage:e.commit_message};case"revert-success-v2":return{createdAt:l(e.created_at),id:e.id,type:"revertSuccessv2",shortCommitHash:null!==(v=e.commit_hash)&&void 0!==v?v:void 0,editId:e.edit_id};case"revert-success":return{createdAt:l(e.created_at),id:e.id,type:"revertSuccess",shortCommitHash:null!==(E=e.commit_hash)&&void 0!==E?E:void 0,editId:null!==(y=e.edit_id)&&void 0!==y?y:""};case"manual-edit":return{createdAt:l(e.created_at),id:e.id,type:"manualEdit",content:e.content,editId:e.edit_id};case"revert":if("user"===e.role)return{createdAt:l(e.created_at),id:e.id,type:"userMessage",content:e.content,containsError:!1,tags:[],images:[],selectedElements:[],userId:e.user_id,role:"user"};return{createdAt:l(e.created_at),id:e.id,type:"aiMessage",content:e.content,role:"ai",persisted:!0,status:"completed",sqlRunState:void 0,stopped:!1};default:return a.P.error("Unknown message tag",{message:e}),null}},i=(e,t)=>{let r={};return e.forEach(e=>{let a=e.data(),n=s(a,t);n&&(r[a.id]=n)}),r}},88746:function(e,t,r){r.d(t,{Y:function(){return i},t:function(){return s}});var a=r(57437),n=r(62869),o=r(26110),l=r(46214);let s=(0,r(59625).Ue)(e=>({open:!1,errorMessage:null,showTryAgain:!0,showErrorDialog:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return l.ZP.capture("error_dialog_shown",{error_message:t,show_try_again:r}),e({open:!0,errorMessage:t,showTryAgain:r})},closeError:()=>e({open:!1,errorMessage:null,showTryAgain:!0})}));function i(){let{open:e,errorMessage:t,closeError:r,showTryAgain:i}=s();return(0,a.jsx)(o.Vq,{open:e,onOpenChange:e=>{e||(l.ZP.capture("error_dialog_closed",{action:"backdrop",error_message:t}),r())},children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsx)(o.$N,{children:"Error"}),(0,a.jsxs)(o.Be,{children:[(t||"An unexpected error occurred. ").split("\n").map((e,r)=>(0,a.jsxs)("span",{children:[e,r!==(t||"An unexpected error occurred. ").split("\n").length-1&&(0,a.jsx)("br",{})]},r)),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("br",{}),(0,a.jsx)("span",{children:"Please try again later."})]})]})]}),(0,a.jsxs)(o.cN,{className:"gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>{l.ZP.capture("error_dialog_closed",{action:"get_help",error_message:t}),r(),window.open("https://docs.lovable.dev/#stay-connected","_blank")},children:"Get help"}),(0,a.jsx)(n.z,{onClick:()=>{l.ZP.capture("error_dialog_closed",{action:"ok",error_message:t}),r()},children:"Dismiss"})]})]})})}},2925:function(e,t,r){r.d(t,{u:function(){return a}});let a=(0,r(59625).Ue)(e=>({currentPage:"index",setCurrentPage:t=>e({currentPage:t})}))},83856:function(e,t,r){r.d(t,{QE:function(){return _},vM:function(){return g},$F:function(){return m},uL:function(){return E}});var a=r(57437),n=r(2265),o=r(48614),l=r(1188),s=e=>{let{isLoading:t}=e,[r,s]=(0,n.useState)(0),[i,d]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{t&&(s(0),d(!0))},[t]),(0,n.useEffect)(()=>{if(!t){s(100);return}let e=[];return[{duration:150,increment:15},{duration:250,increment:10},{duration:400,increment:5},{duration:500,increment:3},{duration:650,increment:3},{duration:750,increment:3},{duration:1500,increment:2},{duration:2e3,increment:1},{duration:3e3,increment:1},{duration:4e3,increment:1},{duration:5e3,increment:1},{duration:6e3,increment:1},{duration:7e3,increment:1},{duration:1e4,increment:1},{duration:14e3,increment:1}].forEach(t=>{let{duration:r,increment:a}=t,n=setTimeout(()=>{s(e=>e<75?e+a+2*Math.random():e)},r);e.push(n)}),()=>{e.forEach(e=>clearTimeout(e))}},[t]),(0,a.jsx)("div",{className:"pointer-events-none absolute left-0 right-0 top-0 h-[3px] w-full overflow-hidden bg-transparent",children:(0,a.jsx)(o.M,{children:i&&(0,a.jsx)(l.E.div,{className:"h-full bg-accent",initial:{width:0,opacity:1},animate:{width:"".concat(Math.min(r,100),"%"),opacity:1},exit:{opacity:0,transition:{delay:.2,duration:.3}},transition:{width:{duration:.15,bounce:0}},onAnimationComplete:()=>{t||d(!1)}})})})},i=r(36710),d=r(90432),c=r(21288),u=r(61062),f=r(7163),p=r(62449);let _=[],g=[],m=[],h=e=>{var t,r,a,n,o,l,s,i;let d=Object.entries(e.headers||{}).reduce((e,t)=>{let[r,a]=t;return e+r.length+String(a).length},0);return((null===(t=e.responseBody)||void 0===t?void 0:t.length)||0)+((null===(r=e.requestBody)||void 0===r?void 0:r.length)||0)+((null===(n=e.error)||void 0===n?void 0:null===(a=n.message)||void 0===a?void 0:a.length)||0)+((null===(l=e.error)||void 0===l?void 0:null===(o=l.stack)||void 0===o?void 0:o.length)||0)+((null===(s=e.url)||void 0===s?void 0:s.length)||0)+((null===(i=e.statusText)||void 0===i?void 0:i.length)||0)+d},v=e=>{var t,r,a,n,o,l;return((null===(t=e.error_type)||void 0===t?void 0:t.length)||0)+((null===(r=e.message)||void 0===r?void 0:r.length)||0)+((null===(a=e.filename)||void 0===a?void 0:a.length)||0)+((null===(n=e.lineno)||void 0===n?void 0:n.toString().length)||0)+((null===(o=e.colno)||void 0===o?void 0:o.toString().length)||0)+((null===(l=e.stack)||void 0===l?void 0:l.length)||0)},E=e=>{let{baseUrl:t,hidden:r=!1,projectId:o,useCustomScript:l=!1}=e,E=(0,p.Eh)(e=>e.isSendChatMessageMutationPending),[y,b]=(0,n.useState)(!0),[w,k]=(0,n.useState)(t),C=(0,n.useRef)(null),S=(0,n.useRef)(!1),P=(0,i.O)(),{errors:x}=(0,d.hT)({projectId:o});(0,n.useEffect)(()=>{if(t){var e;let r=(null===(e=C.current)||void 0===e?void 0:e.src)?new URL(C.current.src).pathname:"";k(r.startsWith("/")&&t.endsWith("/")?t+r.slice(1):t+r)}},[t]);let[M,I]=(0,n.useState)();(0,n.useEffect)(()=>{let e=e=>{"URL_CHANGED"===e.data.type&&C.current?k(e.data.url):"404"===e.data&&b(!1)};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[]),(0,n.useEffect)(()=>{if(!window)return;let e=e=>{if("URL_CHANGED"===e.data.type&&k(t=>{try{if(!t)return e.data.url;{let r=new URL(t),a=new URL(e.data.url);if(r.pathname===a.pathname)return t;return r.pathname=a.pathname,r.toString()}}catch(e){return t}}),"USER_SNAPSHOT"===e.data.type&&"string"==typeof e.data.snapshot)try{I(function(e,t){if(!e.startsWith("data:image/png;base64,"))throw Error("Invalid base64 string");let r=atob(e.split(",")[1]),a=new Uint8Array(r.length);for(let e=0;e<r.length;e++)a[e]=r.charCodeAt(e);return new File([a],t,{type:"image/png"})}(e.data.snapshot,"snapshot.png"))}catch(e){}if("CONSOLE_OUTPUT"===e.data.type){let t={level:e.data.level,message:e.data.message,logged_at:e.data.logged_at};t.message.length>1e4&&(t.message=t.message.slice(0,1e4)),_.push(t);let r=_.reduce((e,t)=>e+t.message.length,0);for(;r>1e4||_.length>50;){let e=_.shift();if(!e)break;r-=e.message.length}}if("NETWORK_REQUEST"===e.data.type){let t={...e.data.request};t.responseBody&&t.responseBody.length>1e4&&(t.responseBody=t.responseBody.slice(0,1e4)),t.requestBody&&t.requestBody.length>1e4&&(t.requestBody=t.requestBody.slice(0,1e4)),t.error&&(t.error.message&&t.error.message.length>1e4&&(t.error.message=t.error.message.slice(0,1e4)),t.error.stack&&t.error.stack.length>1e4&&(t.error.stack=t.error.stack.slice(0,1e4))),t.url&&t.url.length>1e4&&(t.url=t.url.slice(0,1e4)),t.statusText&&t.statusText.length>1e4&&(t.statusText=t.statusText.slice(0,1e4)),g.push(t);let r=g.reduce((e,t)=>e+h(t),0);for(;r>1e5||g.length>50;){let e=g.shift();if(!e)break;r-=h(e)}}if("RUNTIME_ERROR"===e.data.type||"UNHANDLED_PROMISE_REJECTION"===e.data.type){let t=f.jA.safeParse(e.data.error),r=t.success?t.data:e.data.error;t.error&&c.P.error("error_parsing_runtime_error",{error:t.error});let a={error_type:e.data.type,message:r.message||"Unknown error",lineno:r.lineno,colno:r.colno,filename:r.filename,stack:r.stack};a.message.length>1e4&&(a.message=a.message.slice(0,1e4)),a.stack.length>1e4&&(a.stack=a.stack.slice(0,1e4));let n=m.findIndex(e=>e.filename===a.filename&&e.colno===a.colno&&e.lineno===a.lineno);-1!==n&&m.splice(n,1),m.push(a);let o=m.reduce((e,t)=>e+v(t),0);for(;o>1e5||m.length>50;){let e=m.shift();if(!e)break;o-=v(e)}}if("FETCH_ERROR"===e.data.type){let t=f.W3.safeParse(e.data.error),r=t.success?t.data:e.data.error;t.error&&c.P.error("error_parsing_fetch_error",{error:t.error}),"status"in r&&(null==r?void 0:r.status)>=400&&(null==r?void 0:r.status)<500?(0,d.eK)({...r,error_type:u.N.HTTP_CLIENT_ERROR},o,P):(0,d.eK)({...r,error_type:u.N.HTTP_SERVER_ERROR},o,P)}};return window.addEventListener("message",e,!1),()=>{window.removeEventListener("message",e)}},[P,o]);let R=(0,n.useCallback)(e=>{let t=e||w;if(t){if(b(!0),C.current){let e=new URL(t);e.searchParams.set("forceHideBadge","true"),l&&e.searchParams.set("lov-override-script","true"),C.current.src=e.toString()}k(t)}},[w,l]),A=(0,n.useRef)(!0);return(0,n.useEffect)(()=>{if(A.current){A.current=!1;return}R()},[l]),(0,n.useEffect)(()=>{E?x&&x.length>0&&(S.current=!0):(S.current&&R(),S.current=!1)},[x,R,E]),{preview:(0,n.useMemo)(()=>{let e;if(t){var n;e=new URL(t);let r=(null===(n=C.current)||void 0===n?void 0:n.src)?new URL(C.current.src).pathname:"";e.pathname=r,e.searchParams.set("forceHideBadge","true"),l&&e.searchParams.set("lov-override-script","true"),e=e.toString()}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s,{isLoading:y}),(0,a.jsx)("iframe",{id:"preview-panel",style:{opacity:r?0:1},ref:C,src:e,allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",className:"min-h-full w-full flex-grow",onLoad:()=>b(!1)})]})},[t,r,y,l]),refresh:R,isLoading:y,url:w,userSnapshot:M}}},11594:function(e,t,r){r.d(t,{N:function(){return i},i:function(){return d}});var a=r(36710),n=r(21288),o=r(16593),l=r(59625),s=r(88746);let i=(0,l.Ue)(()=>({url:null,status:null})),d=e=>{let{projectId:t,enabled:r=!0,userInitiated:l=!1}=e,{showErrorDialog:d}=(0,s.t)(),c=(0,a.O)();return(0,o.a)({queryKey:["devServer",t],enabled:r,queryFn:async()=>{n.P.debug("starting_dev_server",{enabled:r});try{let e=await c.post("/projects/".concat(t,"/sandbox/start?user_initiated=").concat(l),{project_id:t});return n.P.debug("dev_server_started",{response:e}),i.setState(e),e}catch(r){n.P.error("failed_to_start_dev_server",{error:r});let e,t=!0;throw r instanceof Error?e=r.message:"object"==typeof r&&null!==r&&"data"in r&&"object"==typeof r.data&&null!==r.data&&"detail"in r.data&&(e=String(r.data.detail),t=!1),e&&d(e,t),i.setState({url:null,status:{sandbox:"error",dev_server:{state:"stopped",initialized:!1},shutdown_eta:null,checked_at:null}}),r}},refetchIntervalInBackground:!1,refetchOnMount:!1,refetchOnReconnect:!0,refetchOnWindowFocus:!0,staleTime:6e4,retry:(e,t)=>"status"in t&&423===t.status})}},57346:function(e,t,r){r.d(t,{Z:function(){return tO}});var a=r(57437);r(2265);var n=r(94508),o=r(97139),l=r(26472),s=r(37784),i=r(78330),d=r(30878),c=r(51058),u=r(58046),f=r(48709),p=r(38952),_=r(72738),g=r(96024),m=r(98164),h=r(39543),v=r(79857),E=r(67864),y=r(95592),b=r(8332),w=r(91361),k=r(14893),C=r(89769),S=r(21375),P=r(93886),x=r(1363),M=r(85064),I=r(79580),R=r(65597),A=r(67433),O=r(62178),T=r(95602),j=r(99209),F=r(73649),B=r(71477),N=r(29885),U=r(89003),D=r(7289),z=r(85518),q=r(86007),L=r(79151),H=r(76527),G=r(90489),W=r(59949),Z=r(61276),V=r(49083),J=r(95144),Q=r(1263),K=r(39730),$=r(90966),Y=r(35591),X=r(89971),ee=r(49588),et=r(31017),er=r(58699),ea=r(27317),en=r(21583),eo=r(95051),el=r(80524),es=r(84006),ei=r(73894),ed=r(68115),ec=r(38333),eu=r(81861),ef=r(25700),ep=r(67686),e_=r(67605),eg=r(96357),em=r(21207),eh=r(90349),ev=r(92674),eE=r(30405),ey=r(42787),eb=r(84935),ew=r(81441),ek=r(23584),eC=r(47272),eS=r(84786),eP=r(72872),ex=r(29351),eM=r(18207),eI=r(28525),eR=r(53828),eA=r(35910),eO=r(26710),eT=r(20859),ej=r(85352),eF=r(13108),eB=r(84451),eN=r(82133),eU=r(48629),eD=r(81080),ez=r(95085),eq=r(70757),eL=r(27301),eH=r(90067),eG=r(61190),eW=r(69621),eZ=r(12747),eV=r(93322),eJ=r(74366),eQ=r(85194),eK=r(17017),e$=r(58147),eY=r(59187),eX=r(16980),e0=r(32578),e1=r(31256),e2=r(3034),e4=r(91400),e5=r(84729),e3=r(12280),e7=r(46609),e6=r(73482),e9=r(24291),e8=r(58520),te=r(81459),tt=r(4037),tr=r(19324),ta=r(14103),tn=r(44690),to=r(54125),tl=r(59131),ts=r(48313),ti=r(91530),td=r(68082),tc=r(69169),tu=r(36482),tf=r(42790),tp=r(9844),t_=r(5542),tg=r(96690),tm=r(26457),th=r(36934),tv=r(7124),tE=r(9399),ty=r(26251),tb=r(11132),tw=r(7593),tk=r(57931),tC=r(85024),tS=r(51229),tP=r(92483),tx=r(53939),tM=r(48843),tI=r(24746);let tR={rocket:e3.default,whatshot:o.default,"dock_to_right-fill":V.default,"thumb_down-fill":tp.default,"thumb_up-fill":tg.default,route:e7.default,rss:e6.default,smart_toy:tn.default,account_circle:l.default,add:s.default,add_link:i.default,add_photo_alternate:d.default,arrow_circle_up:c.default,arrow_downward:u.default,arrow_upward:f.default,arrow_right:p.default,arrow_right_alt:_.default,assignment:g.default,attach_file:m.default,auto_stories:h.default,bolt_fill:v.default,bug_report:E.default,build:y.default,cancel:b.default,celebration:w.default,chat:k.default,chat_bubble:C.default,chat_paste_go:S.default,check_small:M.default,check:P.default,check_circle:x.default,chevron_left:I.default,chevron_right:R.default,close:A.default,close_small:O.default,code:T.default,commit:F.default,construction:B.default,contact_support:U.default,content_copy:N.default,conversion_path:D.default,currency_bitcoin:z.default,dashboard:q.default,delete:H.default,deployed_code:G.default,difference:Z.default,dock_to_right:J.default,edit:Q.default,error:$.default,expand_circle_down:Y.default,expand_circle_right:X.default,expand_circle_up:ee.default,experiment_fill:et.default,favorite:er.default,flag:ea.default,flash_on_fill:en.default,flash_on:eo.default,folder:el.default,folder_copy:es.default,footprint:ei.default,forum:ec.default,globe:eu.default,grade:ef.default,group_add:ep.default,help:e_.default,history:eg.default,info:eE.default,import_contacts:ev.default,joystick:ey.default,keyboard_arrow_down:ek.default,kid_star:eC.default,language:eP.default,laptop_mac:ex.default,link:eM.default,local_fire_department:eI.default,local_shipping:eR.default,location_on:eA.default,lock:eT.default,manage_accounts:eF.default,manufacturing:eB.default,more_horiz:ez.default,move_item:eq.default,my_location:eL.default,newspaper:eH.default,note_add:eG.default,note_stack:eW.default,open_in_full:eV.default,open_in_new:eJ.default,page_info:eQ.default,partner_exchange:eK.default,phone_iphone:eY.default,play_circle:eX.default,power_settings_new:e0.default,progress_activity:e2.default,refresh:e4.default,restart_alt:e5.default,scan_delete:e9.default,school:te.default,science:tt.default,search:e8.default,settings:tr.default,shuffle:ta.default,stop_circle:to.default,stylus_note:tl.default,support_agent:ti.default,support:ts.default,swap_horiz:td.default,table:tc.default,thumb_down:tf.default,thumb_up:t_.default,timelapse:tm.default,undo:th.default,visibility_off:tE.default,visibility:tv.default,warning:ty.default,web:tb.default,location_searching:eO.default,text_fields:tu.default,notes:eZ.default,format_list_bulleted:ed.default,rocket_launch:tP.default,enterprise:K.default,imagesmode:eh.default,preview:e1.default,database:L.default,code_blocks:j.default,keyboard:ew.default,home:em.default,menu:eN.default,logout:ej.default,key:eb.default,menu_book:eU.default,payments:e$.default,description:W.default,lab_research:eS.default,monitoring:eD.default,figma_logo_outline:tw.default,figma_logo_color:tk.default,lovable_logo_color:tC.default,builder_io_logo:tS.default,arrow_left_alt:tx.default,bookmark:tI.default,bookmark_fill:tM.default},tA={xsmall:"h-3 w-3",small:"h-4 w-4",default:"h-5 w-5",large:"h-6 w-6",xlarge:"h-8 w-8"};var tO=e=>{let{name:t,size:r="default",className:o,...l}=e,s=tR[t],i=tA[r];return s?(0,a.jsx)(s,{width:"100%",height:"100%",className:(0,n.cn)("shrink-0",i,o),fill:"currentColor",...l}):null}},26815:function(e,t,r){r.d(t,{_:function(){return d}});var a=r(57437),n=r(2265),o=r(6394),l=r(77712),s=r(94508);let i=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.f,{ref:t,className:(0,s.cn)(i(),r),...n})});d.displayName=o.f.displayName},74991:function(e,t,r){r.d(t,{E:function(){return i},m:function(){return d}});var a=r(57437),n=r(2265),o=r(42325),l=r(94508),s=r(20653);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.fC,{className:(0,l.cn)("grid gap-2",r),...n,ref:t})});i.displayName=o.fC.displayName;let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.ck,{ref:t,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),...n,children:(0,a.jsx)(o.z$,{className:"flex items-center justify-center",children:(0,a.jsx)(s.jXb,{className:"h-3.5 w-3.5 fill-primary"})})})});d.displayName=o.ck.displayName},43206:function(e,t,r){r.d(t,{Z:function(){return l}});var a=r(2265),n=()=>{let[e,t]=(0,a.useState)({width:void 0,height:void 0});return(0,a.useEffect)(()=>{{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}},[]),e};let o={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};var l=e=>{if("number"==typeof e&&e<0)throw Error("Breakpoint value must be positive");let t=n(),r=(0,a.useMemo)(()=>"number"==typeof e?e:o[e],[e]);return(0,a.useMemo)(()=>void 0!==t.width&&t.width<r,[t.width,r])}},46366:function(e,t,r){r.d(t,{c:function(){return o}});var a=r(49340),n=r(25134);let o=()=>{let[e,t]=(0,a.a)(),{userData:r,isInitialized:o}=(0,n.v)();return!t&&o&&(null==r?void 0:r.is_admin)}},5810:function(e,t,r){r.d(t,{DZ:function(){return p},PY:function(){return _},vp:function(){return f}});var a=r(14438),n=r(62449),o=r(5978),l=r(99376),s=r(2265),i=r(78099),d=r(21288),c=r(49340),u=r(25134);let f=()=>{let e=(0,l.useParams)().project_id;return e&&"string"==typeof e?e:null},p=()=>{let e=f();if(!e)throw Error("Project ID is required and should always be set here");return e},_=()=>{let e=f(),t=(0,l.useRouter)(),r=(0,n.Eh)(e=>e.setProject),p=(0,n.Eh)(e=>e.setIsProjectLoaded),_=(0,n.Eh)(e=>e.isProjectBeingDeleted),[g,m,h]=(0,c.a)(),{userData:v,isInitialized:E}=(0,u.v)(),y=(0,n.Eh)(e=>e.hasHandledCollaborationInvite);(0,s.useEffect)(()=>{if(!e||!y||!E||!v)return;let n=(0,o.JU)(i.db,"projects",e),l=(0,o.cf)(n,a=>{let n=a.data();n?(r(n),p(!0)):_||(d.P.error("PROJECT NOT FOUND V2",{projectId:e,docExists:a.exists(),userId:null==g?void 0:g.uid}),t.push("/projects/not-found"))},r=>{if(d.P.error("PROJECT PERMISSION ERROR",{error:r,projectId:e}),"permission-denied"===r.code){d.P.error("PROJECT PERMISSION DENIED",{error:r,projectId:e}),t.replace("/?should-refresh-credentials=1"),t.refresh();return}a.Am.error("Error",{description:"Failed to fetch project."})});return()=>{l()}},[e,v,E,a.Am,t,_,y,p,r,g,m,h])}},90432:function(e,t,r){r.d(t,{H$:function(){return g},eK:function(){return m},qV:function(){return h},hT:function(){return E}});var a=r(5978),n=r(2265),o=r(78099),l=r(11594),s=r(36710),i=r(21770),d=r(2208),c=r(21288),u=r(61062),f=r(7163);r(83079);var p=(0,r(12119).$)("b7d51bc7164a5e626545613d8ab46b33e129918e");function _(e){var t,r,a;let n=e.meta_data?"|".concat(null===(t=e.meta_data)||void 0===t?void 0:t.colno,"|").concat(null===(r=e.meta_data)||void 0===r?void 0:r.lineno,"|").concat(null===(a=e.meta_data)||void 0===a?void 0:a.filename):"";return"".concat(e.error_message,"|").concat(e.type).concat(n)}function g(e){return e.filter((e,t,r)=>t===r.findIndex(t=>_(t)===_(e)))}async function m(e,t,r){try{let a=await p(e);if(!a){c.P.debug("skipping_reporting_error",{error:e,err_message:e.message});return}let n=a.error_type;await r.post("/projects/".concat(t,"/report_error"),{message:null==a?void 0:a.message,error_type:n,meta_data:a})}catch(e){c.P.error("failed_to_report_intercepted_error",{error:e})}}function h(e){let{projectId:t,errorIds:r,setErrors:a}=e,n=(0,s.O)();return(0,i.D)({mutationFn:async()=>{a([]),await n.post("/projects/".concat(t,"/handle_errors"),{error_ids:r})},onError:e=>{c.P.error("failed_to_submit_handled_errors",{error:e})}})}let v=e=>{e.sort((e,t)=>e.type===u.N.RUNTIME&&t.type!==u.N.RUNTIME?-1:t.created_at.seconds-e.created_at.seconds);let t={uniqueErrors:[],runtimeErrorMessages:new Set};return e.reduce((e,t)=>{if(t.type===u.N.IMMEDIATE_RUNTIME||t.type===u.N.RUNTIME){let r=t.error_message.replace(/\?v=[a-z0-9]{8}/,"?'");e.runtimeErrorMessages.has(r)||(e.runtimeErrorMessages.add(r),e.uniqueErrors.push(t))}else e.uniqueErrors.push(t);return e},t).uniqueErrors},E=e=>{let{projectId:t}=e,[r,i]=(0,n.useState)([]),u=(0,s.O)(),p=(0,l.N)(e=>e.url),_=p&&"string"==typeof p?p.replace("http://","ws://").replace("https://","wss://"):p;(0,d.ZP)(_,{protocols:"vite-hmr",onMessage:e=>{try{let a=JSON.parse(e.data);if((null==a?void 0:a.type)==="error"){var r;c.P.info("build_error_from_devserver",{message:null==a?void 0:null===(r=a.err)||void 0===r?void 0:r.message});let e=f.pw.safeParse(null==a?void 0:a.err);e.success?m(e.data,t,u):(c.P.error("error_parsing_devserver_error",{error:e}),m(null==a?void 0:a.err,t,u))}}catch(e){c.P.error("error_parsing_devserver_error",{error:e})}},onOpen:e=>{c.P.debug("devserver_websocket_open")},onClose:e=>{c.P.debug("devserver_websocket_close")},onError:e=>{c.P.error("devserver_websocket_error",{event:e})},shouldReconnect:()=>!0,reconnectInterval:1e3});let g=h({projectId:t,errorIds:r.map(e=>e.id),setErrors:i});return(0,n.useEffect)(()=>{let e=function(e,t){let r=(0,a.hJ)(o.db,"projects/".concat(e,"/errors")),n=(0,a.IO)(r,(0,a.ar)("handled_at","==",null));return(0,a.cf)(n,e=>{e.empty?t([]):t(e.docs.map(e=>({...e.data(),id:e.id})))})}(t,i);return()=>e()},[t]),{errors:(0,n.useMemo)(()=>0===r.length?null:v(r),[r]),setErrors:i,handleErrorMutation:r.length>0?g:null}}},98507:function(e,t,r){r.d(t,{C:function(){return l}});var a=r(1787),n=r(62449),o=r(16593);let l=e=>{let t=(0,n.Eh)(e=>e.userProjectPermissions),r=(0,a.M)(),{data:l,refetch:s,isLoading:i,error:d}=(0,o.a)({queryKey:["repo-accessibility",e],queryFn:()=>e?r.get("/projects/".concat(e,"/repo-accessibility")).then(e=>e.json()):null,enabled:t.edit});return{repoAccessibilityResponse:l,refetchRepoAccessibility:s,isLoading:i,error:d}}},78844:function(e,t,r){r.d(t,{h:function(){return s}});var a=r(14438),n=r(21288),o=r(2265),l=r(25566);let s=e=>{let[t,r]=(0,o.useState)(!1);return{handleConnect:(0,o.useCallback)(async()=>{r(!0);try{let t=window.location.origin,r=btoa(JSON.stringify({projectId:e})),a=l.env.NEXT_PUBLIC_SUPABASE_OAUTH_CLIENT_ID||"dbd565fc-4637-4cb6-ab68-0af4b5708417",n=function(){let e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(),o=await i(n);localStorage.setItem("supabaseCodeVerifier",n);let s="https://api.supabase.com/v1/oauth/authorize?response_type=code"+"&client_id=".concat(a)+"&redirect_uri=".concat(encodeURIComponent("".concat(t,"/supabase/callback")))+"&state=".concat(encodeURIComponent(r))+"&code_challenge=".concat(encodeURIComponent(o))+"&code_challenge_method=S256",d=window.open(s,"_blank","width=600,height=700,left=100,top=100");d?d.focus():window.location.href=s}catch(e){n.P.error("Error initiating Supabase connection:",{error:e}),a.Am.error("Connection Error",{description:"An error occurred while connecting to Supabase. Please try again."})}finally{r(!1)}},[e,a.Am]),isConnecting:t}};async function i(e){let t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(r)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},1787:function(e,t,r){r.d(t,{M:function(){return i}});var a=r(99376),n=r(52558),o=r(2265),l=r(29388),s=r(25057);let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=(0,a.useRouter)(),r=(0,a.usePathname)(),{authUser:i}=(0,n.E)(),[d,c]=(0,o.useState)(()=>new l.og((0,s.t)(),null==i?void 0:i.idToken,t,r,e));return(0,o.useEffect)(()=>{c(new l.og((0,s.t)(),null==i?void 0:i.idToken,t,r,e))},[t,r,e,i]),d}},26034:function(e,t,r){r.d(t,{S:function(){return o},c:function(){return n}});var a=r(21288);let n=async(e,t,n)=>{let o=n;if(n.type.startsWith("image/")){let e=new Image;if(e.src=URL.createObjectURL(n),await new Promise(t=>e.onload=t),n.size>3145728||Math.max(e.width,e.height)>2e3)try{let{default:e}=await r.e(4937).then(r.bind(r,24937));o=await e(n,{maxSizeMB:3,maxWidthOrHeight:1920,useWebWorker:!0})}catch(e){a.P.error("Error compressing image:",{error:e})}}let l={file_name:t,content_type:o.type,status:"uploading"},s=await e.post("/generate-file-upload-url",l);await fetch(s.url,{method:"PUT",body:o,headers:{"Content-Type":o.type}})},o=async(e,t)=>await e.post("/generate-file-download-url",t)},61062:function(e,t,r){var a,n;r.d(t,{N:function(){return a}}),(n=a||(a={})).IMMEDIATE_RUNTIME="immediate_runtime",n.RUNTIME="runtime",n.BUILD="build",n.DEPLOY_SUPABASE_FUNCTIONS="deploy_supabase_functions",n.HTTP_CLIENT_ERROR="http_client_error",n.CORS_ERROR="cors_error",n.HTTP_SERVER_ERROR="http_server_error",n.NO_CODE_CHANGE="no_code_change",n.CODE_DIFF="code_diff",n.FILE_EDITED_WITHOUT_PERMISSION="file_edited_without_permission",n.EXCLUDED_FILE_EDITED="excluded_file_edited",n.SUPABASE_EDGE_FUNCTION_ERROR="supabase_edge_function_error",n.DEPENDENCY_INSTALL="dependency_install",n.SUPABASE_SQL_ERROR="supabase_sql_error",n.SEARCH_REPLACE_FAILED="search_replace_failed",n.SEARCH_REPLACE_MISSING_FILE="search_replace_missing_file",n.CHANGED_MISSING_FILE="changed_missing_file"},94508:function(e,t,r){r.d(t,{cn:function(){return o}});var a=r(54365),n=r(71407);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m)((0,a.W)(t))}},7163:function(e,t,r){r.d(t,{W3:function(){return d},jA:function(){return l},pw:function(){return o}});var a=r(31229),n=r(61062);let o=a.z.object({frame:a.z.string().optional(),id:a.z.string().optional(),loc:a.z.object({file:a.z.string().optional(),line:a.z.number().optional(),column:a.z.number().optional()}).optional(),message:a.z.string(),plugin:a.z.string().optional(),pluginCode:a.z.string().optional(),stack:a.z.string().optional()}).transform(e=>({...e,error_type:n.N.IMMEDIATE_RUNTIME})),l=a.z.object({message:a.z.string(),stack:a.z.string(),filename:a.z.string().optional(),lineno:a.z.number().optional(),colno:a.z.number().optional()}).transform(e=>({...e,error_type:n.N.RUNTIME})),s=a.z.object({body:a.z.string(),message:a.z.string(),status:a.z.number(),statusText:a.z.string().optional(),url:a.z.string()}),i=a.z.object({message:a.z.string(),method:a.z.enum(["OPTIONS","GET","POST","PUT","DELETE","PATCH"]),origin:a.z.string().optional(),stack:a.z.string().optional(),url:a.z.string()}),d=a.z.union([s,i])},62449:function(e,t,r){r.d(t,{Eh:function(){return c},Nk:function(){return f},es:function(){return o},jE:function(){return l}});var a,n,o,l,s=r(59625),i=r(89134);(a=o||(o={})).RAW="RAW",a.DIFF="DIFF",(n=l||(l={})).DEFAULT="default",n.CHAT_ONLY="chat-only",n.AGENT="agent";let d={isSendChatMessageMutationPending:!1,isProjectLoaded:!1,isSomeRevertMutationPending:!1,activeMessageId:void 0,activeConsoleCodeContent:void 0,activeConsoleErrorContent:void 0,activeConsolePreviewContent:void 0,project:void 0,isProjectBeingDeleted:!1,latestStreamedMessage:void 0,consoleContentType:null,abortControllers:[],chatMessage:"",userProjectPermissions:{admin:!1,edit:!1},isProjectCollaborator:!1,hasHandledCollaborationInvite:!1,isRemixDialogOpen:!1,activeEdit:void 0,isBrowsingHistory:!1,codeViewType:"RAW",isPickAndEditActive:!1,selectedElements:[],optimisticMessages:[],images:[],chatMode:"default",customScript:!1,shouldShowTipsAndTricksOnDevServerStart:!1},c=(0,s.Ue)((e,t)=>({...d,addOptimisticMessage:t=>e(e=>({optimisticMessages:[...e.optimisticMessages,t]})),removeOptimisticMessage:t=>e(e=>({optimisticMessages:e.optimisticMessages.filter(e=>e.id!==t)})),setIsSomeRevertMutationPending:t=>e({isSomeRevertMutationPending:t}),setIsSendChatMessageMutationPending:t=>e({isSendChatMessageMutationPending:t}),setShowConsole:t=>{e({consoleContentType:t})},setActiveMessageId:t=>e({activeMessageId:t}),setConsoleCodeContent:t=>e({activeConsoleCodeContent:t}),setConsoleErrorContent:t=>e({activeConsoleErrorContent:t}),setConsolePreviewContent:t=>e({activeConsolePreviewContent:t}),setProject:t=>e({project:t}),setProjectBeingDeleted:t=>e({isProjectBeingDeleted:t}),setLatestStreamedMessage:t=>e({latestStreamedMessage:t}),reset:()=>e(e=>(e.abortControllers.forEach(e=>e.abort()),{...d,abortControllers:[]})),addAbortController:t=>e(e=>({abortControllers:[...e.abortControllers,t]})),removeAbortController:t=>e(e=>({abortControllers:e.abortControllers.filter(e=>e!==t)})),setChatMessage:t=>e({chatMessage:t}),setUserProjectPermissions:t=>e({userProjectPermissions:t}),setIsProjectCollaborator:t=>e({isProjectCollaborator:t}),setHasHandledCollaboratorInvite:t=>e({hasHandledCollaborationInvite:t}),setIsRemixDialogOpen:t=>e({isRemixDialogOpen:t}),setActiveEdit:t=>e({activeEdit:t}),setIsBrowsingHistory:t=>{"function"==typeof t?e(e=>({isBrowsingHistory:t(e.isBrowsingHistory)})):e({isBrowsingHistory:t})},toggleDebugMode:()=>{e(e=>({debugMode:!e.debugMode}))},setIsProjectLoaded:t=>e({isProjectLoaded:t}),exitConsole:()=>e({consoleContentType:null,activeMessageId:void 0,activeConsoleErrorContent:void 0,activeConsoleCodeContent:void 0,activeConsolePreviewContent:void 0,activeEdit:void 0}),setCodeViewType:t=>e({codeViewType:t}),setIsPickAndEditActive:t=>{"function"==typeof t?e(e=>({isPickAndEditActive:t(e.isPickAndEditActive)})):e({isPickAndEditActive:t})},setSelectedElements:t=>e({selectedElements:t}),addSelectedElement:t=>e(e=>({selectedElements:[...e.selectedElements,t]})),shouldBlockActions:()=>{let{isSendChatMessageMutationPending:e,isSomeRevertMutationPending:r}=t();return e||r},setImages:t=>{Array.isArray(t)?e({images:t}):e(e=>({images:t(e.images)}))},removeSelectedElement:t=>e(e=>({selectedElements:e.selectedElements.filter(e=>e.filePath!==t.filePath||e.lineNumber!==t.lineNumber)})),setChatMode:t=>{"function"==typeof t?e(e=>({chatMode:t(e.chatMode)})):e({chatMode:t})},setCustomScript:t=>e({customScript:t}),setShouldShowTipsAndTricksOnDevServerStart:t=>e({shouldShowTipsAndTricksOnDevServerStart:t})})),u={experimentalFeatures:{chatModes:!1,apiKeysInChat:!1,codeEditor:!1}},f=(0,s.Ue)()((0,i.mW)((0,i.tJ)(e=>({...u,setExperimentalFeature:(t,r)=>{e(e=>({experimentalFeatures:{...e.experimentalFeatures,[t]:r}}))}}),{name:"app-state"})))}}]);