!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="67f70c32-fb15-43ff-bec4-230c4a755879",e._sentryDebugIdIdentifier="sentry-dbid-67f70c32-fb15-43ff-bec4-230c4a755879")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{35198:function(e,t,r){Promise.resolve().then(r.t.bind(r,47960,23)),Promise.resolve().then(r.bind(r,34207)),Promise.resolve().then(r.bind(r,68687)),Promise.resolve().then(r.bind(r,33414)),Promise.resolve().then(r.bind(r,33606)),Promise.resolve().then(r.t.bind(r,88003,23)),Promise.resolve().then(r.t.bind(r,94132,23)),Promise.resolve().then(r.t.bind(r,27895,23)),Promise.resolve().then(r.t.bind(r,79402,23)),Promise.resolve().then(r.t.bind(r,81012,23))},25134:function(e,t,r){"use strict";r.d(t,{d:function(){return u},v:function(){return a}});var n=r(52558),o=r(78099),i=r(5978),s=r(2265);let a=()=>{let[e,t]=(0,s.useState)(void 0),{isInitialized:r,authUser:a}=(0,n.E)();return(0,s.useEffect)(()=>{var e,n;if(!r)return;let s=null!==(n=null==a?void 0:a.uid)&&void 0!==n?n:null===(e=o.I.currentUser)||void 0===e?void 0:e.uid;if(!s)return;let u=(0,i.JU)(o.db,"users",s);return(0,i.cf)(u,e=>{t(e.data())})},[a,r]),{userData:e,isInitialized:r}},u=()=>{let{userData:e}=a();if(e)return e.is_admin||"free"!==e.plan}},52558:function(e,t,r){"use strict";r.d(t,{E:function(){return f},H:function(){return g}});var n=r(57437),o=r(78099),i=r(21288),s=r(99376),a=r(2265),u=r(28667);let c=()=>{let[e,t,r]=(0,u.F_)(o.I);return[e,t,r]},l=(0,a.createContext)(void 0),d=null,f=()=>{let e=(0,a.useContext)(l);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e},g=e=>{let{user:t,children:r}=e,[f,g]=(0,a.useState)(!1),[p]=c(),[v,m,h]=(0,u.QJ)(o.I),b=(0,s.useRouter)();return(0,a.useEffect)(()=>((async function(){if(!t){g(!1),d&&(clearInterval(d),d=null);return}await (0,o.j)(t.customToken,!0),g(!0),d||(d=setInterval(async()=>{let e=o.I.currentUser;if(!e){await (0,o.j)(t.customToken,!0);return}try{await e.getIdToken(!0)}catch(e){var r;i.P.error("AuthProvider: Failed to refresh Firebase token",{error:e,userId:null===o.I||void 0===o.I?void 0:null===(r=o.I.currentUser)||void 0===r?void 0:r.uid})}b.replace("?should-refresh-credentials=1"),b.refresh()},18e5))})(),()=>{!t&&d&&(clearInterval(d),d=null)}),[t,b]),(0,a.useEffect)(()=>{!t&&p&&(i.P.info("Setting user cookie based on IndexDB and deleting IndexDB"),p.getIdToken().then(async e=>{try{if((await fetch("/api/login",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).ok){b.replace("?should-refresh-credentials=1"),i.P.info("Successfully set auth cookies");let e=new URLSearchParams(window.location.search).get("redirect");e&&b.push(e),b.refresh()}else i.P.info("Failed to set auth cookies. Did not remove IndexedDB.")}catch(e){i.P.warn("Unknown error when trying to set auth cookies. Did not remove IndexedDB.",{error:e})}}))},[p,b,v,t]),(0,n.jsx)(l.Provider,{value:{authUser:t,isInitialized:f},children:r})}},34207:function(e,t,r){"use strict";r.d(t,{Providers:function(){return I}});var n=r(57437),o=r(2265),i=r(78298);function s(e){let{children:t,...r}=e;return(0,n.jsx)(i.f,{...r,children:t})}var a=r(52558),u=r(49340),c=r(21288),l=r(22048),d=r(99376),f=r(46214),g=r(23664);let p="phc_xdBVCyOkYw40Pqd7xp5Er88lGq2IGFd4kZHRiKvvkjr",v=p&&!0;function m(e){let{children:t,bootstrapData:r}=e,[i,s,a]=(0,u.a)(),c=(0,u.e)(),m=(0,o.useMemo)(()=>null==i?void 0:i.uid,[null==i?void 0:i.uid]),h=(0,o.useMemo)(()=>null==i?void 0:i.displayName,[null==i?void 0:i.displayName]);return(0,o.useEffect)(()=>{m&&l.av({id:m})},[m]),(0,o.useEffect)(()=>{v&&m&&(f.ZP.identify(m,{email:c,name:h}),f.ZP.set_config({persistence:"localStorage+cookie"}))},[m,c,h]),(0,o.useEffect)(()=>{v&&f.ZP.init(p,{api_host:"https://lovable.dev/ingest",ui_host:"https://us.posthog.com",persistence:"memory",bootstrap:r,session_recording:{maskAllInputs:!1,maskInputOptions:{password:!0}},autocapture:{element_allowlist:["button"]}})},[r]),function(){let e=(0,d.usePathname)();(0,o.useEffect)(()=>{f.ZP.capture("$pageview")},[e])}(),(0,n.jsx)(g.zf,{client:f.ZP,children:t})}p||c.P.info("Missing NEXT_PUBLIC_POSTHOG_KEY in env; set to 'skip' to disable");var h=r(21623),b=r(29827);let E=new h.S,P=e=>{let{children:t}=e;return(0,n.jsx)(b.aH,{client:E,children:t})},I=e=>{let{user:t,children:r,bootstrapData:o}=e;return(0,n.jsx)(a.H,{user:t,children:(0,n.jsx)(m,{bootstrapData:o,children:(0,n.jsx)(P,{children:(0,n.jsx)(s,{attribute:"class",defaultTheme:"dark",enableSystem:!0,children:r})})})})}},68687:function(e,t,r){"use strict";r.d(t,{FeatureFlagsInitializer:function(){return u},ZW:function(){return a},bW:function(){return i},ye:function(){return s}});var n=r(23664),o=r(2265);let i=(0,r(59625).Ue)((e,t)=>({flags:{},setFlags:t=>e({flags:t,initialized:!0}),getFlag:e=>{var r;let{flags:n}=t();return null!==(r=n[e])&&void 0!==r&&r},initialized:!1})),s=e=>i(t=>t.getFlag(e)),a=()=>i(e=>e.initialized),u=()=>{let e=i(e=>e.setFlags),t=(0,n.ND)();return(0,o.useEffect)(()=>{var r;e(null!==(r=null==t?void 0:t.reduce((e,t)=>(e[t]=!0,e),{}))&&void 0!==r?r:{})},[t,e]),null}},33414:function(e,t,r){"use strict";r.d(t,{ObservabilityInitializer:function(){return a}});var n=r(5810),o=r(49340),i=r(21288),s=r(2265);function a(){let[e]=(0,o.a)(),t=(0,i.G)(e=>e.metadata);(0,s.useEffect)(()=>{e&&!t.user&&t.setUser({id:e.uid,email:e.email||void 0,user_name:e.displayName||void 0})},[e,t]);let r=(0,n.vp)(),a=(0,s.useRef)(null);return(0,s.useEffect)(()=>{r!==a.current&&r&&t.setSession(r),a.current=r},[r,t]),null}},33606:function(e,t,r){"use strict";r.d(t,{Toaster:function(){return s}});var n=r(57437),o=r(78298),i=r(14438);let s=e=>{let{...t}=e,{theme:r="system"}=(0,o.F)();return(0,n.jsx)(i.x7,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",closeButton:"-right-1 top-2 left-auto group-[.toast]:bg-transparent border-none opacity-0 group-hover:opacity-100 transition-opacity duration-125 ease-out group-[.toast]:hover:text-foreground group-[.toast]:text-muted-foreground",icon:"group-data-[type=error]:text-destructive group-data-[type=success]:text-success group-data-[type=warning]:text-warning group-data-[type=info]:text-accent"}},...t})}},5810:function(e,t,r){"use strict";r.d(t,{DZ:function(){return g},PY:function(){return p},vp:function(){return f}});var n=r(14438),o=r(62449),i=r(5978),s=r(99376),a=r(2265),u=r(78099),c=r(21288),l=r(49340),d=r(25134);let f=()=>{let e=(0,s.useParams)().project_id;return e&&"string"==typeof e?e:null},g=()=>{let e=f();if(!e)throw Error("Project ID is required and should always be set here");return e},p=()=>{let e=f(),t=(0,s.useRouter)(),r=(0,o.Eh)(e=>e.setProject),g=(0,o.Eh)(e=>e.setIsProjectLoaded),p=(0,o.Eh)(e=>e.isProjectBeingDeleted),[v,m,h]=(0,l.a)(),{userData:b,isInitialized:E}=(0,d.v)(),P=(0,o.Eh)(e=>e.hasHandledCollaborationInvite);(0,a.useEffect)(()=>{if(!e||!P||!E||!b)return;let o=(0,i.JU)(u.db,"projects",e),s=(0,i.cf)(o,n=>{let o=n.data();o?(r(o),g(!0)):p||(c.P.error("PROJECT NOT FOUND V2",{projectId:e,docExists:n.exists(),userId:null==v?void 0:v.uid}),t.push("/projects/not-found"))},r=>{if(c.P.error("PROJECT PERMISSION ERROR",{error:r,projectId:e}),"permission-denied"===r.code){c.P.error("PROJECT PERMISSION DENIED",{error:r,projectId:e}),t.replace("/?should-refresh-credentials=1"),t.refresh();return}n.Am.error("Error",{description:"Failed to fetch project."})});return()=>{s()}},[e,b,E,n.Am,t,p,P,g,r,v,m,h])}},49340:function(e,t,r){"use strict";r.d(t,{a:function(){return o},e:function(){return i}});var n=r(52558);let o=()=>{let{authUser:e}=(0,n.E)();return[e,!1,null]},i=()=>{let[e,t,r]=o();return null==e?void 0:e.email}},54257:function(e,t,r){"use strict";r.d(t,{q:function(){return n}});let n="production"===(r(25566).env.NEXT_PUBLIC_NODE_ENV||"production")?{apiKey:"AIzaSyBQNjlw9Vp4tP4VVeANzyPJnqbG2wLbYPw",authDomain:"auth.gptengineer.app",projectId:"gpt-engineer-390607",storageBucket:"gpt-engineer-390607.appspot.com",messagingSenderId:"288002387414",appId:"1:288002387414:web:231da37c38c486ca814877",measurementId:"G-EFZ8TB5QLN",clientEmail:"firebase-adminsdk-thfj5@gpt-engineer-390607.iam.gserviceaccount.com"}:{apiKey:"AIzaSyC8MAnZTLUBttWHlEIMl0u8gGI0R5oGnXU",authDomain:"gpt-engineer-dev.firebaseapp.com",projectId:"gpt-engineer-dev",storageBucket:"gpt-engineer-dev.appspot.com",messagingSenderId:"435422046193",appId:"1:435422046193:web:36e2c4049799e14110c650",clientEmail:"firebase-adminsdk-tg5bc@gpt-engineer-dev.iam.gserviceaccount.com"}},78099:function(e,t,r){"use strict";r.d(t,{I:function(){return l},db:function(){return c},j:function(){return f}});var n=r(738),o=r(44752),i=r(5978),s=r(54257),a=r(46886),u=r(21288);let{db:c,auth:l}=(()=>{let e=(0,n.ZF)(s.q),t=(0,i.LV)(e,{experimentalForceLongPolling:!0}),r=(0,o.v0)(e);return{app:e,db:t,auth:r}})(),d=!1,f=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!d&&t&&e){d=!0;let t=await (0,a.Q9)({serverCustomToken:e,refreshTokenUrl:"/api/refresh-token"});if(!t)return d=!1,u.P.error("No custom token found in initialize()"),{db:c,auth:l};try{await (0,o._p)(l,t)}catch(e){u.P.error("Unable to sign-in with custom-token in firebase initialization: ".concat(e)),d=!1}}return{db:c,auth:l}}},21288:function(e,t,r){"use strict";r.d(t,{G:function(){return l},P:function(){return g}});var n,o,i=r(59625),s=r(49360),a=r(25566);(n=o||(o={})).LOG="LOG",n.TRACE="TRACE",n.DEBUG="DEBUG",n.INFO="INFO",n.WARN="WARN",n.ERROR="ERROR";class u{static generateSessionId(){return(0,s.Z)()}setSession(e){this._session={session_id:u.generateSessionId(),previous_session:this._session.session_id,project_id:e}}setUser(e){this._user=e}get session(){return this._session}get user(){return this._user}sessionForLogging(){let{session_id:e,...t}=this._session;return{session_id:e,...Object.fromEntries(Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["session_attrs_".concat(t),r]}))}}userForLogging(){return Object.fromEntries(Object.entries(this._user||{}).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return["user_".concat(t),r]}))}getForLogging(){return Object.fromEntries(Object.entries({...this.sessionForLogging(),...this.userForLogging()}).filter(e=>{let[t,r]=e;return void 0!==r}))}constructor(){this._session={session_id:u.generateSessionId()}}}let c=new u,l=(0,i.Ue)(e=>({metadata:c,setMetadata:t=>e({metadata:t})})),d=async(e,t)=>{let r=t[0],n=t[1]?Object.fromEntries(Object.entries(t[1]).map(e=>{let[t,r]=e;return[t,r instanceof Error?r.toString():r instanceof Date?r.toISOString():"object"==typeof r&&null!==r?JSON.stringify(r):(null==r?void 0:r.toString())||null]})):{},o=(1e9*Math.floor(Date.now()/1e3)).toString(),i=Object.entries({msg:r,...n,...c.getForLogging(),level:e}).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(JSON.stringify(r))}).join(" "),s={streams:[{stream:{service_name:"gptengineer-app",name:"gptengineer-app",version:a.env.NEXT_PUBLIC_VERSION||"1.0.0",environment:"production",commit_sha:"4ee7fab5ab65943174f26e0d230c9b16601c7dd0",level:e},values:[[o,i]]}]},u="https://us-central1-gpt-engineer-390607.cloudfunctions.net/pushLogsToGrafana";if(u)try{await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}catch(e){}},f=(e,t)=>{d(e,t)},g={info:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f("INFO",t)},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f("DEBUG",t)},trace:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f("TRACE",t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f("WARN",t)},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f("ERROR",t)}}},62449:function(e,t,r){"use strict";r.d(t,{Eh:function(){return l},Nk:function(){return f},es:function(){return i},jE:function(){return s}});var n,o,i,s,a=r(59625),u=r(89134);(n=i||(i={})).RAW="RAW",n.DIFF="DIFF",(o=s||(s={})).DEFAULT="default",o.CHAT_ONLY="chat-only",o.AGENT="agent";let c={isSendChatMessageMutationPending:!1,isProjectLoaded:!1,isSomeRevertMutationPending:!1,activeMessageId:void 0,activeConsoleCodeContent:void 0,activeConsoleErrorContent:void 0,activeConsolePreviewContent:void 0,project:void 0,isProjectBeingDeleted:!1,latestStreamedMessage:void 0,consoleContentType:null,abortControllers:[],chatMessage:"",userProjectPermissions:{admin:!1,edit:!1},isProjectCollaborator:!1,hasHandledCollaborationInvite:!1,isRemixDialogOpen:!1,activeEdit:void 0,isBrowsingHistory:!1,codeViewType:"RAW",isPickAndEditActive:!1,selectedElements:[],optimisticMessages:[],images:[],chatMode:"default",customScript:!1,shouldShowTipsAndTricksOnDevServerStart:!1},l=(0,a.Ue)((e,t)=>({...c,addOptimisticMessage:t=>e(e=>({optimisticMessages:[...e.optimisticMessages,t]})),removeOptimisticMessage:t=>e(e=>({optimisticMessages:e.optimisticMessages.filter(e=>e.id!==t)})),setIsSomeRevertMutationPending:t=>e({isSomeRevertMutationPending:t}),setIsSendChatMessageMutationPending:t=>e({isSendChatMessageMutationPending:t}),setShowConsole:t=>{e({consoleContentType:t})},setActiveMessageId:t=>e({activeMessageId:t}),setConsoleCodeContent:t=>e({activeConsoleCodeContent:t}),setConsoleErrorContent:t=>e({activeConsoleErrorContent:t}),setConsolePreviewContent:t=>e({activeConsolePreviewContent:t}),setProject:t=>e({project:t}),setProjectBeingDeleted:t=>e({isProjectBeingDeleted:t}),setLatestStreamedMessage:t=>e({latestStreamedMessage:t}),reset:()=>e(e=>(e.abortControllers.forEach(e=>e.abort()),{...c,abortControllers:[]})),addAbortController:t=>e(e=>({abortControllers:[...e.abortControllers,t]})),removeAbortController:t=>e(e=>({abortControllers:e.abortControllers.filter(e=>e!==t)})),setChatMessage:t=>e({chatMessage:t}),setUserProjectPermissions:t=>e({userProjectPermissions:t}),setIsProjectCollaborator:t=>e({isProjectCollaborator:t}),setHasHandledCollaboratorInvite:t=>e({hasHandledCollaborationInvite:t}),setIsRemixDialogOpen:t=>e({isRemixDialogOpen:t}),setActiveEdit:t=>e({activeEdit:t}),setIsBrowsingHistory:t=>{"function"==typeof t?e(e=>({isBrowsingHistory:t(e.isBrowsingHistory)})):e({isBrowsingHistory:t})},toggleDebugMode:()=>{e(e=>({debugMode:!e.debugMode}))},setIsProjectLoaded:t=>e({isProjectLoaded:t}),exitConsole:()=>e({consoleContentType:null,activeMessageId:void 0,activeConsoleErrorContent:void 0,activeConsoleCodeContent:void 0,activeConsolePreviewContent:void 0,activeEdit:void 0}),setCodeViewType:t=>e({codeViewType:t}),setIsPickAndEditActive:t=>{"function"==typeof t?e(e=>({isPickAndEditActive:t(e.isPickAndEditActive)})):e({isPickAndEditActive:t})},setSelectedElements:t=>e({selectedElements:t}),addSelectedElement:t=>e(e=>({selectedElements:[...e.selectedElements,t]})),shouldBlockActions:()=>{let{isSendChatMessageMutationPending:e,isSomeRevertMutationPending:r}=t();return e||r},setImages:t=>{Array.isArray(t)?e({images:t}):e(e=>({images:t(e.images)}))},removeSelectedElement:t=>e(e=>({selectedElements:e.selectedElements.filter(e=>e.filePath!==t.filePath||e.lineNumber!==t.lineNumber)})),setChatMode:t=>{"function"==typeof t?e(e=>({chatMode:t(e.chatMode)})):e({chatMode:t})},setCustomScript:t=>e({customScript:t}),setShouldShowTipsAndTricksOnDevServerStart:t=>e({shouldShowTipsAndTricksOnDevServerStart:t})})),d={experimentalFeatures:{chatModes:!1,apiKeysInChat:!1,codeEditor:!1}},f=(0,a.Ue)()((0,u.mW)((0,u.tJ)(e=>({...d,setExperimentalFeature:(t,r)=>{e(e=>({experimentalFeatures:{...e.experimentalFeatures,[t]:r}}))}}),{name:"app-state"})))},47960:function(){}},function(e){e.O(0,[3587,1609,2708,4358,1413,5878,9013,5658,4438,1262,8322,991,2971,1370,1744],function(){return e(e.s=35198)}),_N_E=e.O()}]);